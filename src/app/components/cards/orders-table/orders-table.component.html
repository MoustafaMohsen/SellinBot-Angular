<div
  class="relative flex flex-col min-w-0 break-words w-full mb-6 shadow-lg rounded"
  [ngClass]="color === 'light' ? 'bg-white' : 'bg-red-900 text-white'"
>
  <div class="rounded-t mb-0 px-4 py-3 border-0">
    <div class="flex flex-wrap items-center">
      <div class="relative w-full px-4 max-w-full flex-grow flex-1">
        <h3
          class="font-semibold text-lg"
          [ngClass]="color === 'light' ? 'text-blueGray-700' : 'text-white'"
        >
          Orders Table
        </h3>
      </div>
    </div>
  </div>
  <div class="block w-full overflow-x-auto">
    <!-- Projects table -->
    <table class="items-center w-full bg-transparent border-collapse">
      <thead>
        <tr>
          <th
            class="px-6 align-middle border border-solid py-3 text-xs border-l-0 border-r-0 whitespace-nowrap font-semibold text-left"
            [ngClass]="
              color === 'light'
                ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100'
                : 'bg-red-800 text-red-300 border-red-700'
            "
          >
            Id
          </th>
          <th
            class="px-6 align-middle border border-solid py-3 text-xs border-l-0 border-r-0 whitespace-nowrap font-semibold text-left"
            [ngClass]="
              color === 'light'
                ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100'
                : 'bg-red-800 text-red-300 border-red-700'
            "
          >
            Customer Id
          </th>
          <th
            class="px-6 align-middle border border-solid py-3 text-xs border-l-0 border-r-0 whitespace-nowrap font-semibold text-left"
            [ngClass]="
              color === 'light'
                ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100'
                : 'bg-red-800 text-red-300 border-red-700'
            "
          >
            Country
          </th>
          <!-- <th
            class="px-6 align-middle border border-solid py-3 text-xs border-l-0 border-r-0 whitespace-nowrap font-semibold text-left"
            [ngClass]="
              color === 'light'
                ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100'
                : 'bg-red-800 text-red-300 border-red-700'
            "
          >
            Products
          </th> -->

          <th
            class="px-6 align-middle border border-solid py-3 text-xs border-l-0 border-r-0 whitespace-nowrap font-semibold text-left"
            [ngClass]="
              color === 'light'
                ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100'
                : 'bg-red-800 text-red-300 border-red-700'
            "
          >
            Total
          </th>
          <th
            class="px-6 align-middle border border-solid py-3 text-xs border-l-0 border-r-0 whitespace-nowrap font-semibold text-left"
            [ngClass]="
              color === 'light'
                ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100'
                : 'bg-red-800 text-red-300 border-red-700'
            "
          >
            Status
          </th>
          <th
            class="px-6 align-middle border border-solid py-3 text-xs border-l-0 border-r-0 whitespace-nowrap font-semibold text-left"
            [ngClass]="
              color === 'light'
                ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100'
                : 'bg-red-800 text-red-300 border-red-700'
            "
          >View</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let o of orders">
          <th
            class="border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4 text-left"
          >
            <!-- id -->
            {{ o.orders_id }}
          </th>
          <th
            class="border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4 text-left"
          >
            <!-- Customer id -->
            {{ o.customer_id }}
          </th>
          <th
            class="border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4 text-left"
          >
            <!-- id -->
            {{ o.country }}
          </th>
          <!-- products -->
          <!-- <td class="border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4" >
            {{ o.products }}
          </td> -->
          <td
            class="border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4"
          >
            <!-- status -->
            {{ orderTotal(o) }}
          </td>
          <td
            class="border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4"
          >
            <!-- status -->
            {{ o.status }}
          </td>
          <td
            class="border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4"
          >
            <button
              (click)="view(o)"
              class="bg-lightBlue-600 text-white active:bg-lightBlue-600 text-xs font-bold px-3 py-1 rounded outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150"
              type="button"
            >
              View Order
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!--Modal-->
<div
  class="open-order-modal modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center"
>
  <div
    class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50 z-50"
  ></div>
  <div
    class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto"
  >
    <!-- Add margin if you want to see some of the overlay behind the modal-->
    <div
      class="modal-content py-4 text-left px-6"
      style="width: 36rem; padding: 2.5rem 2rem"
    >
      <!--Title-->
      <div class="flex justify-between items-center pb-3 mb-6">
        <p class="text-3xl font-bold">Order Details</p>
        <div
          (click)="modal.closeModal()"
          class="modal-close cursor-pointer z-50"
        >
          <svg
            class="fill-current text-black"
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="18"
            viewBox="0 0 18 18"
          >
            <path
              d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"
            ></path>
          </svg>
        </div>
      </div>
      <!--Body-->
      <div class="order-details">
        <div class="flex flex-col">
          <!-- <p>  {{modal_order?.orders_id}} </p>
        <p>  {{modal_order?.phone}} </p>
        <p>  {{modal_order?.address}} </p>
        <p>  {{modal_order?.status}} </p>
        <p>  {{modal_order?.country}} </p>
        <p>  {{modal_order?.name}} </p>
        <p>  {{modal_order?.customer_id}} </p>
        <p>  {{modal_order?.products}} </p> -->

          <p class="mb-2">
            <span class="mr-2 font-bold text-xl text-lightBlue-700"
              >Order-Id :</span
            >
            {{ modal_order?.orders_id }}
          </p>
          <p class="mb-2">
            <span class="mr-2 font-bold text-xl text-lightBlue-700"
              >Phone :</span
            >
            {{ modal_order?.phone }}
          </p>
          <p class="mb-2">
            <span class="mr-2 font-bold text-xl text-lightBlue-700"
              >Address :</span
            >
            {{ modal_order?.address }}
          </p>
          <p class="mb-2">
            <span class="mr-2 font-bold text-xl text-lightBlue-700"
              >Status :</span
            >
            {{ modal_order?.status }}
          </p>
          <p class="mb-2">
            <span class="mr-2 font-bold text-xl text-lightBlue-700"
              >Country :</span
            >
            {{ modal_order?.country }}
          </p>
          <p class="mb-2">
            <span class="mr-2 font-bold text-xl text-lightBlue-700"
              >Name :</span
            >
            {{ modal_order?.name }}
          </p>
          <p class="mb-2">
            <span class="mr-2 font-bold text-xl text-lightBlue-700"
              >Customer-Id
            </span>
            {{ modal_order?.customer_id }}
          </p>
          <div class="mb-2">
            <span class="mr-2 font-bold text-xl text-lightBlue-700"
              >Products:
            </span>
            <p class="mb-2" *ngFor="let p of modal_order?.meta.products">
              Code:{{ p.products_id }}, Name:{{ p.name }}, price:{{ p.price }}
            </p>
          </div>
        </div>
      </div>

      <div class="flex justify-start pt-2">
        <button
          (click)="viewConvo()"
          class="px-4 bg-lightBlue-600 p-3 rounded-lg text-white hover:bg-lightBlue-500"
        >
          View conversation
        </button>
      </div>

      <!--Footer-->
      <div class="flex justify-end pt-2">
        <button
          (click)="modal.closeModal()"
          class="bg-transparent border-blueGray-600 text-gray-700 border-2 p-2 px-6 rounded-lg mr-2"
        >
          Close
        </button>
      </div>
    </div>
    <small style="color: red">{{ text }}</small>
  </div>
</div>
<!--End Modal-->

<!--open convo Modal-->
<div
  class="open-order-convo-modal modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center"
>
  <div
    class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50 z-50"
  ></div>
  <div
    class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto"
  >
    <!-- Add margin if you want to see some of the overlay behind the modal-->
    <div
      class="modal-content py-4 text-left px-6"
      style="width: 36rem; padding: 1.5rem 1rem"
    >
      <!--Title-->
      <div class="flex justify-between items-center pb-3 mb-6">
        <p class="text-2xl font-bold">Conversation Details</p>
        <div
          (click)="modal.closeModal()"
          class="modal-close cursor-pointer z-50"
        >
          <svg
            class="fill-current text-black"
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="18"
            viewBox="0 0 18 18"
          >
            <path
              d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"
            ></path>
          </svg>
        </div>
      </div>
      <!--Body-->
      <div class="">
        <!-- <p *ngFor="let m of modal_conversation?.meta?.messages">{{m.sender}}: {{m.text}}</p> -->
        <!-- Chat Start -->

        <div
          class="flex flex-col flex-grow w-full min-h-screen-75 bg-white rounded-lg overflow-hidden"
        >
          <div class="flex flex-col flex-grow h-0 p-4 overflow-auto">
            <div *ngFor="let m of modal_conversation?.meta?.messages">
              <div
                *ngIf="m.sender == 'Customer'"
                class="flex w-full mt-2 space-x-3 max-w-xs"
              >
                <div>
                  <div class="bg-blueGray-200 p-3 rounded-r-lg rounded-bl-lg">
                    <p class="text-sm text-gray-800">{{ m.text }}</p>
                  </div>
                  <!-- <span class="text-xs text-gray-400 leading-none">2 min ago</span> -->
                </div>
              </div>
              <div
                *ngIf="m.sender == 'Bot'"
                class="flex w-full mt-2 space-x-3 max-w-xs ml-auto justify-end"
              >
                <div>
                  <div
                    class="bg-lightBlue-900 text-white p-3 rounded-l-lg rounded-br-lg"
                  >
                    <p class="text-sm text-gray-50">{{ m.text }}</p>
                  </div>
                  <!-- <span class="text-xs text-gray-500 leading-none">2 min ago</span> -->
                </div>
              </div>
            </div>
          </div>

          <!-- Chat End  -->
        </div>
      </div>

      <!--Footer-->
      <div class="flex justify-end pt-2">
        <button
          (click)="modal2.closeModal()"
          class="bg-transparent border-blueGray-600 text-gray-700 border-2 p-2 px-6 rounded-lg mr-2"
        >
          Close
        </button>
      </div>
    </div>
  </div>
</div>
<!--End convo Modal-->
